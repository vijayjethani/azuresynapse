{
	"name": "Notebook 1",
	"properties": {
		"nbformat": 4,
		"nbformat_minor": 2,
		"bigDataPool": {
			"referenceName": "vijayapachepool",
			"type": "BigDataPoolReference"
		},
		"sessionProperties": {
			"driverMemory": "28g",
			"driverCores": 4,
			"executorMemory": "28g",
			"executorCores": 4,
			"numExecutors": 2,
			"conf": {
				"spark.dynamicAllocation.enabled": "false",
				"spark.dynamicAllocation.minExecutors": "2",
				"spark.dynamicAllocation.maxExecutors": "2"
			}
		},
		"metadata": {
			"saveOutput": true,
			"synapse_widget": {
				"version": "0.1",
				"state": {
					"6c83eb62-ed00-43b1-95d6-0c75154ae860": {
						"type": "Synapse.DataFrame",
						"sync_state": {
							"table": {
								"rows": [
									{
										"startLon": "-73.95500946044922",
										"puLocationId": "null",
										"startLat": "40.73378372192383",
										"rateCodeId": "1",
										"passengerCount": "1",
										"puMonth": "3",
										"tpepPickupDateTime": "2015-02-28 23:32:43",
										"mtaTax": "0.5",
										"improvementSurcharge": "0.3",
										"tpepDropoffDateTime": "2015-03-01 00:02:05",
										"doLocationId": "null",
										"paymentType": "2",
										"tripDistance": "8.66",
										"vendorID": "2",
										"endLon": "-73.9688491821289",
										"totalAmount": "30.3",
										"storeAndFwdFlag": "N",
										"puYear": "2015",
										"extra": "0.5",
										"endLat": "40.67795181274414",
										"fareAmount": "29.0",
										"tipAmount": "0.0",
										"tollsAmount": "0.0"
									},
									{
										"startLon": "-73.9888916015625",
										"puLocationId": "null",
										"startLat": "40.758304595947266",
										"rateCodeId": "1",
										"passengerCount": "1",
										"puMonth": "3",
										"tpepPickupDateTime": "2015-02-28 23:41:32",
										"mtaTax": "0.5",
										"improvementSurcharge": "0.3",
										"tpepDropoffDateTime": "2015-03-01 00:08:59",
										"doLocationId": "null",
										"paymentType": "2",
										"tripDistance": "4.8",
										"vendorID": "1",
										"endLon": "-73.91947174072266",
										"totalAmount": "21.3",
										"storeAndFwdFlag": "N",
										"puYear": "2015",
										"extra": "0.5",
										"endLat": "40.75845718383789",
										"fareAmount": "20.0",
										"tipAmount": "0.0",
										"tollsAmount": "0.0"
									},
									{
										"startLon": "-73.98031616210938",
										"puLocationId": "null",
										"startLat": "40.77208709716797",
										"rateCodeId": "1",
										"passengerCount": "1",
										"puMonth": "3",
										"tpepPickupDateTime": "2015-02-28 23:43:39",
										"mtaTax": "0.5",
										"improvementSurcharge": "0.3",
										"tpepDropoffDateTime": "2015-03-01 00:06:14",
										"doLocationId": "null",
										"paymentType": "2",
										"tripDistance": "3.96",
										"vendorID": "2",
										"endLon": "-73.9767074584961",
										"totalAmount": "18.3",
										"storeAndFwdFlag": "N",
										"puYear": "2015",
										"extra": "0.5",
										"endLat": "40.73244857788086",
										"fareAmount": "17.0",
										"tipAmount": "0.0",
										"tollsAmount": "0.0"
									},
									{
										"startLon": "-73.99098205566406",
										"puLocationId": "null",
										"startLat": "40.73460388183594",
										"rateCodeId": "1",
										"passengerCount": "2",
										"puMonth": "3",
										"tpepPickupDateTime": "2015-02-28 23:22:27",
										"mtaTax": "0.5",
										"improvementSurcharge": "0.3",
										"tpepDropoffDateTime": "2015-03-01 00:07:12",
										"doLocationId": "null",
										"paymentType": "2",
										"tripDistance": "9.4",
										"vendorID": "1",
										"endLon": "-73.91658782958984",
										"totalAmount": "36.3",
										"storeAndFwdFlag": "N",
										"puYear": "2015",
										"extra": "0.5",
										"endLat": "40.64944839477539",
										"fareAmount": "35.0",
										"tipAmount": "0.0",
										"tollsAmount": "0.0"
									},
									{
										"startLon": "-73.9870834350586",
										"puLocationId": "null",
										"startLat": "40.72951889038086",
										"rateCodeId": "1",
										"passengerCount": "1",
										"puMonth": "3",
										"tpepPickupDateTime": "2015-02-28 23:59:10",
										"mtaTax": "0.5",
										"improvementSurcharge": "0.3",
										"tpepDropoffDateTime": "2015-03-01 00:03:36",
										"doLocationId": "null",
										"paymentType": "1",
										"tripDistance": "0.7",
										"vendorID": "1",
										"endLon": "-73.98332214355469",
										"totalAmount": "7.56",
										"storeAndFwdFlag": "N",
										"puYear": "2015",
										"extra": "0.5",
										"endLat": "40.72229766845703",
										"fareAmount": "5.0",
										"tipAmount": "1.26",
										"tollsAmount": "0.0"
									},
									{
										"startLon": "-73.96588897705078",
										"puLocationId": "null",
										"startLat": "40.71061706542969",
										"rateCodeId": "1",
										"passengerCount": "1",
										"puMonth": "3",
										"tpepPickupDateTime": "2015-02-28 23:52:38",
										"mtaTax": "0.5",
										"improvementSurcharge": "0.3",
										"tpepDropoffDateTime": "2015-03-01 00:35:54",
										"doLocationId": "null",
										"paymentType": "1",
										"tripDistance": "5.4",
										"vendorID": "2",
										"endLon": "-73.98374938964844",
										"totalAmount": "35.16",
										"storeAndFwdFlag": "N",
										"puYear": "2015",
										"extra": "0.5",
										"endLat": "40.73839569091797",
										"fareAmount": "28.0",
										"tipAmount": "5.86",
										"tollsAmount": "0.0"
									},
									{
										"startLon": "-73.98614501953125",
										"puLocationId": "null",
										"startLat": "40.730979919433594",
										"rateCodeId": "1",
										"passengerCount": "2",
										"puMonth": "3",
										"tpepPickupDateTime": "2015-02-28 23:59:08",
										"mtaTax": "0.5",
										"improvementSurcharge": "0.3",
										"tpepDropoffDateTime": "2015-03-01 00:17:53",
										"doLocationId": "null",
										"paymentType": "1",
										"tripDistance": "4.0",
										"vendorID": "1",
										"endLon": "-74.00798797607422",
										"totalAmount": "21.35",
										"storeAndFwdFlag": "N",
										"puYear": "2015",
										"extra": "0.5",
										"endLat": "40.704856872558594",
										"fareAmount": "16.5",
										"tipAmount": "3.55",
										"tollsAmount": "0.0"
									},
									{
										"startLon": "-73.95538330078125",
										"puLocationId": "null",
										"startLat": "40.78017044067383",
										"rateCodeId": "1",
										"passengerCount": "1",
										"puMonth": "3",
										"tpepPickupDateTime": "2015-02-28 10:47:27",
										"mtaTax": "0.5",
										"improvementSurcharge": "0.3",
										"tpepDropoffDateTime": "2015-03-01 10:45:00",
										"doLocationId": "null",
										"paymentType": "1",
										"tripDistance": "0.98",
										"vendorID": "2",
										"endLon": "-73.96331787109375",
										"totalAmount": "8.4",
										"storeAndFwdFlag": "N",
										"puYear": "2015",
										"extra": "0.0",
										"endLat": "40.77479553222656",
										"fareAmount": "6.5",
										"tipAmount": "1.1",
										"tollsAmount": "0.0"
									},
									{
										"startLon": "-73.98506927490234",
										"puLocationId": "null",
										"startLat": "40.74848175048828",
										"rateCodeId": "1",
										"passengerCount": "2",
										"puMonth": "3",
										"tpepPickupDateTime": "2015-02-28 23:58:47",
										"mtaTax": "0.5",
										"improvementSurcharge": "0.3",
										"tpepDropoffDateTime": "2015-03-01 00:08:02",
										"doLocationId": "null",
										"paymentType": "2",
										"tripDistance": "1.6",
										"vendorID": "1",
										"endLon": "-73.98119354248047",
										"totalAmount": "9.3",
										"storeAndFwdFlag": "N",
										"puYear": "2015",
										"extra": "0.5",
										"endLat": "40.764556884765625",
										"fareAmount": "8.0",
										"tipAmount": "0.0",
										"tollsAmount": "0.0"
									},
									{
										"startLon": "-73.98872375488281",
										"puLocationId": "null",
										"startLat": "40.731266021728516",
										"rateCodeId": "1",
										"passengerCount": "1",
										"puMonth": "3",
										"tpepPickupDateTime": "2015-02-28 03:07:05",
										"mtaTax": "0.5",
										"improvementSurcharge": "0.3",
										"tpepDropoffDateTime": "2015-03-01 00:00:00",
										"doLocationId": "null",
										"paymentType": "1",
										"tripDistance": "0.9",
										"vendorID": "2",
										"endLon": "-74.00213623046875",
										"totalAmount": "9.36",
										"storeAndFwdFlag": "N",
										"puYear": "2015",
										"extra": "0.5",
										"endLat": "40.732994079589844",
										"fareAmount": "6.5",
										"tipAmount": "1.56",
										"tollsAmount": "0.0"
									}
								],
								"schema": {
									"vendorID": "string",
									"tpepPickupDateTime": "int",
									"tpepDropoffDateTime": "int",
									"passengerCount": "int",
									"tripDistance": "double",
									"puLocationId": "string",
									"doLocationId": "string",
									"startLon": "double",
									"startLat": "double",
									"endLon": "double",
									"endLat": "double",
									"rateCodeId": "int",
									"storeAndFwdFlag": "string",
									"paymentType": "string",
									"fareAmount": "double",
									"extra": "double",
									"mtaTax": "double",
									"improvementSurcharge": "string",
									"tipAmount": "double",
									"tollsAmount": "double",
									"totalAmount": "double",
									"puYear": "int",
									"puMonth": "int"
								}
							},
							"isSummary": false,
							"language": "scala"
						},
						"persist_state": {
							"view": {
								"type": "details",
								"chartOptions": {
									"chartType": "bar",
									"aggregationType": "sum",
									"categoryFieldKeys": [
										"vendorID"
									],
									"seriesFieldKeys": [
										"tpepPickupDateTime"
									],
									"isStacked": false
								}
							}
						}
					}
				}
			},
			"kernelspec": {
				"name": "synapse_pyspark",
				"display_name": "Synapse PySpark"
			},
			"language_info": {
				"name": "python"
			},
			"a365ComputeOptions": {
				"id": "/subscriptions/c5e95693-4d23-4d5c-ad8d-904f30699ecc/resourceGroups/vijaysynapse/providers/Microsoft.Synapse/workspaces/vijaysynapseworkspace/bigDataPools/vijayapachepool",
				"name": "vijayapachepool",
				"type": "Spark",
				"endpoint": "https://vijaysynapseworkspace.dev.azuresynapse.net/livyApi/versions/2019-11-01-preview/sparkPools/vijayapachepool",
				"auth": {
					"type": "AAD",
					"authResource": "https://dev.azuresynapse.net"
				},
				"sparkVersion": "2.4",
				"nodeCount": 10,
				"cores": 4,
				"memory": 28,
				"automaticScaleJobs": false
			},
			"sessionKeepAliveTimeout": 30
		},
		"cells": [
			{
				"cell_type": "code",
				"metadata": {
					"collapsed": false
				},
				"source": [
					"from azureml.opendatasets import NycTlcYellow\n",
					"\n",
					"data = NycTlcYellow()\n",
					"df = data.to_spark_dataframe()\n",
					"# Display 10 rows\n",
					"display(df.limit(10))"
				],
				"execution_count": 1
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					},
					"collapsed": true
				},
				"source": [
					"df.printSchema()"
				],
				"execution_count": 2
			}
		]
	}
}